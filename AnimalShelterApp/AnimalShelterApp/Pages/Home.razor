@page "/"
@inject AuthService AuthService
@inject NavigationManager NavigationManager

<PageTitle>Home</PageTitle>

@if (AuthService.CurrentUser != null)
{
    <div class="container">
        <div class="jumbotron">
            <h1 class="display-4">Welcome to Pet Medication Tracker!</h1>
            <p class="lead">
                Hello, @AuthService.CurrentUser.DisplayName! This dashboard will help you track medications for all animals in @shelter.Name.
            </p>
            <hr class="my-4">
            <p>
                Get started by adding animals and their medication schedules. Then use the main dashboard to log doses as they're administered.
            </p>
            <div class="mt-4">
                <a class="btn btn-primary btn-lg me-2" href="animals">Manage Animals</a>
                <a class="btn btn-info btn-lg" href="medications">Manage Medications</a>
            </div>
        </div>
    </div>
}
else
{
    <div class="container">
        <div class="jumbotron">
            <h1 class="display-4">Welcome to Pet Medication Tracker!</h1>
            <p class="lead">
                The easiest way to track medication administration for animal shelters and rescues.
            </p>
            <hr class="my-4">
            <p>
                Please log in or create a new account to get started.
            </p>
            <div class="mt-4">
                <a class="btn btn-primary btn-lg me-2" href="login">Login</a>
                <a class="btn btn-success btn-lg" href="register">Create Account</a>
            </div>
        </div>
    </div>
}

@code {
    private Shelter shelter = new Shelter(); 

    protected override async Task OnInitializedAsync()
    {
        // Subscribe to auth state changes
        AuthService.OnAuthStateChanged += StateHasChanged;

        // If logged in, get shelter information
        if (AuthService.CurrentUser != null)
        {
            // In a real implementation, we would fetch the shelter from FirestoreService
            shelter = new Shelter { 
                Id = AuthService.CurrentUser.ShelterId,
                Name = "Your Shelter" // Placeholder, will be replaced with actual data later
            };
        }
    }

    public void Dispose()
    {
        AuthService.OnAuthStateChanged -= StateHasChanged;
    }
}
